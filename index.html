<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Gestion Mobile Money Pro</title>

<style>
body {font-family: Arial; background:#0f172a; margin:0; color:white}
h1 {text-align:center; padding:15px}
.container {background:white; color:black; margin:15px; padding:15px; border-radius:15px}
input, select, button {padding:8px; margin:5px; border-radius:8px; border:1px solid #ccc}
button {cursor:pointer; background:#0f172a; color:white}
.card {background:#f1f5f9; padding:8px; margin:5px; border-radius:8px}
.hidden {display:none}
hr {margin:25px 0}
</style>

</head>
<body>

<h1>Gestion Mobile Money Pro</h1>

<div class="container">

<!-- üîê LOGIN -->
<div id="loginSection">
<h2>Connexion Admin</h2>
<input type="password" id="adminPassword" placeholder="Mot de passe">
<button onclick="login()">Se connecter</button>
</div>

<!-- üîì MAIN APP -->
<div id="appSection" class="hidden">

<button onclick="logout()">D√©connexion</button>

<h2>Solde Caisse</h2>
<p>USD: <span id="caisseUSD">0</span></p>
<p>CDF: <span id="caisseCDF">0</span></p>

<h2>Solde Op√©rateurs</h2>
<div id="operatorBalances"></div>

<hr>

<h2>Nouvelle Transaction</h2>

<select id="operatorSelect"></select>
<select id="typeSelect"></select>

<select id="currency">
<option value="USD">USD</option>
<option value="CDF">CDF</option>
</select>

<input type="number" id="amount" placeholder="Montant">
<input type="text" id="motif" placeholder="Motif">

<button onclick="addTransaction()">Valider</button>

<hr>

<h2>√âchange USD ‚áÑ CDF</h2>

<select id="exchangeDirection">
<option value="USDtoCDF">USD ‚Üí CDF</option>
<option value="CDFtoUSD">CDF ‚Üí USD</option>
</select>

<input type="number" id="exchangeAmount" placeholder="Montant">
<button onclick="exchange()">√âchanger</button>

<hr>

<h2>Filtrer Historique</h2>
<input type="date" id="startDate">
<input type="date" id="endDate">
<button onclick="filterHistory()">Filtrer</button>
<button onclick="display()">R√©initialiser</button>

<hr>

<h2>Historique</h2>
<div id="history"></div>

<hr>

<h2>ADMIN - Soldes Initiaux</h2>

<h3>Caisse</h3>
<input type="number" id="initUSD" placeholder="USD">
<input type="number" id="initCDF" placeholder="CDF">
<button onclick="setInitialCaisse()">D√©finir</button>

<hr>

<h3>Op√©rateurs</h3>
<input type="text" id="newOperator" placeholder="Nom op√©rateur">
<input type="number" id="opInitUSD" placeholder="USD">
<input type="number" id="opInitCDF" placeholder="CDF">
<button onclick="addOperator()">Ajouter</button>

<div id="operatorList"></div>

<hr>

<h3>Types d'op√©ration</h3>
<input type="text" id="newTypeName" placeholder="Nom type">

<select id="impactCaisse">
<option value="1">Caisse +</option>
<option value="-1">Caisse -</option>
<option value="0">Pas caisse</option>
</select>

<select id="impactOperateur">
<option value="1">Op√©rateur +</option>
<option value="-1">Op√©rateur -</option>
<option value="0">Pas op√©rateur</option>
</select>

<button onclick="addType()">Ajouter Type</button>
<div id="typeList"></div>

<hr>

<h3>Param√®tres</h3>

<input type="password" id="newPassword" placeholder="Nouveau mot de passe">
<button onclick="changePassword()">Changer mot de passe</button>

<br>

<input type="number" id="exchangeRate" placeholder="Taux USD ‚Üí CDF">
<button onclick="setRate()">D√©finir Taux</button>

</div>
</div>

<script>

let caisse = JSON.parse(localStorage.getItem("caisse")) || {USD:0,CDF:0}
let operators = JSON.parse(localStorage.getItem("operators")) || []
let types = JSON.parse(localStorage.getItem("types")) || []
let transactions = JSON.parse(localStorage.getItem("transactions")) || []
let adminPassword = localStorage.getItem("adminPassword") || "admin123"
let exchangeRate = parseFloat(localStorage.getItem("exchangeRate")) || 2500
let loggedIn = localStorage.getItem("loggedIn") || "false"

function saveAll(){
localStorage.setItem("caisse",JSON.stringify(caisse))
localStorage.setItem("operators",JSON.stringify(operators))
localStorage.setItem("types",JSON.stringify(types))
localStorage.setItem("transactions",JSON.stringify(transactions))
localStorage.setItem("adminPassword",adminPassword)
localStorage.setItem("exchangeRate",exchangeRate)
localStorage.setItem("loggedIn",loggedIn)
}

function login(){
let pass=document.getElementById("adminPassword").value
if(pass===adminPassword){
loggedIn="true"
saveAll()
showApp()
}else{
alert("Mot de passe incorrect")
}
}

function logout(){
loggedIn="false"
saveAll()
location.reload()
}

function showApp(){
if(loggedIn==="true"){
document.getElementById("loginSection").classList.add("hidden")
document.getElementById("appSection").classList.remove("hidden")
display()
}
}

function changePassword(){
let newPass=document.getElementById("newPassword").value
if(!newPass)return
adminPassword=newPass
saveAll()
alert("Mot de passe modifi√©")
}

function setRate(){
let rate=parseFloat(document.getElementById("exchangeRate").value)
if(rate>0){
exchangeRate=rate
saveAll()
alert("Taux mis √† jour")
}
}

function setInitialCaisse(){
caisse.USD=parseFloat(document.getElementById("initUSD").value)||0
caisse.CDF=parseFloat(document.getElementById("initCDF").value)||0
saveAll()
display()
}

function addOperator(){
let name=document.getElementById("newOperator").value
let usd=parseFloat(document.getElementById("opInitUSD").value)||0
let cdf=parseFloat(document.getElementById("opInitCDF").value)||0
if(!name)return
operators.push({name,USD:usd,CDF:cdf})
saveAll()
display()
}

function deleteOperator(i){
operators.splice(i,1)
saveAll()
display()
}

function addType(){
let name=document.getElementById("newTypeName").value
let impactCaisse=parseInt(document.getElementById("impactCaisse").value)
let impactOperateur=parseInt(document.getElementById("impactOperateur").value)
if(!name)return
types.push({name,impactCaisse,impactOperateur})
saveAll()
display()
}

function deleteType(i){
types.splice(i,1)
saveAll()
display()
}

function addTransaction(){

let opIndex=document.getElementById("operatorSelect").value
let typeIndex=document.getElementById("typeSelect").value
let currency=document.getElementById("currency").value
let amount=parseFloat(document.getElementById("amount").value)
let motif=document.getElementById("motif").value

if(amount<=0)return

let operator=operators[opIndex]
let type=types[typeIndex]

caisse[currency]+= amount * type.impactCaisse
operator[currency]+= amount * type.impactOperateur

transactions.push({
date:new Date(),
operator:operator.name,
type:type.name,
currency,
amount,
motif
})

saveAll()
display()
}

function exchange(){

let direction=document.getElementById("exchangeDirection").value
let amount=parseFloat(document.getElementById("exchangeAmount").value)
if(amount<=0)return

if(direction==="USDtoCDF"){
caisse.USD-=amount
caisse.CDF+=amount*exchangeRate
transactions.push({
date:new Date(),
operator:"Caisse",
type:"√âchange USD‚ÜíCDF",
currency:"USD",
amount,
motif:"√âchange automatique"
})
}

if(direction==="CDFtoUSD"){
caisse.CDF-=amount
caisse.USD+=amount/exchangeRate
transactions.push({
date:new Date(),
operator:"Caisse",
type:"√âchange CDF‚ÜíUSD",
currency:"CDF",
amount,
motif:"√âchange automatique"
})
}

saveAll()
display()
}

function filterHistory(){

let start=new Date(document.getElementById("startDate").value)
let end=new Date(document.getElementById("endDate").value)

let filtered=transactions.filter(t=>{
let d=new Date(t.date)
return d>=start && d<=end
})

displayHistory(filtered)
}

function display(){

document.getElementById("caisseUSD").innerText=caisse.USD
document.getElementById("caisseCDF").innerText=caisse.CDF

let opHTML=""
let opSelect=""
operators.forEach((op,i)=>{
opHTML+=`<div class="card">${op.name} | USD:${op.USD} | CDF:${op.CDF}
<button onclick="deleteOperator(${i})">X</button></div>`
opSelect+=`<option value="${i}">${op.name}</option>`
})
document.getElementById("operatorBalances").innerHTML=opHTML
document.getElementById("operatorList").innerHTML=opHTML
document.getElementById("operatorSelect").innerHTML=opSelect

let typeHTML=""
let typeSelect=""
types.forEach((t,i)=>{
typeHTML+=`<div class="card">${t.name}
<button onclick="deleteType(${i})">X</button></div>`
typeSelect+=`<option value="${i}">${t.name}</option>`
})
document.getElementById("typeList").innerHTML=typeHTML
document.getElementById("typeSelect").innerHTML=typeSelect

displayHistory(transactions)
}

function displayHistory(list){
let historyHTML=""
list.slice().reverse().forEach(t=>{
historyHTML+=`<div class="card">
${new Date(t.date).toLocaleString()} |
${t.operator} |
${t.type} |
${t.amount} ${t.currency}
<br>Motif: ${t.motif}
</div>`
})
document.getElementById("history").innerHTML=historyHTML
}

showApp()

  <script type="module">

  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-analytics.js";
// TODO: Add SDKs for Firebase products that you want to use
// https://firebase.google.com/docs/web/setup#available-libraries

// Your web app's Firebase configuration
// For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {
  apiKey: "AIzaSyDSK9sIPu8fvGebZQG9EdHBhlf7nl8Dmzs",
  authDomain: "mka-mobile-money.firebaseapp.com",
  databaseURL: "https://mka-mobile-money-default-rtdb.firebaseio.com",
  projectId: "mka-mobile-money",
  storageBucket: "mka-mobile-money.firebasestorage.app",
  messagingSenderId: "787998930063",
  appId: "1:787998930063:web:95152b3105e0ed8dc3ecfa",
  measurementId: "G-9Y0ESBEERW"
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);
const analytics = getAnalytics(app);

</script>
  
</body>
  </html>
